[{"id":"9f32eb7d.c3b0b8","type":"chatbot-telegram-receive","z":"e945691.5e02098","bot":"ceee600a.9673d","botProduction":"ceee600a.9673d","x":190,"y":240,"wires":[["1a6234a3.0ddb4b"]]},{"id":"1a6234a3.0ddb4b","type":"chatbot-rules","z":"e945691.5e02098","name":"","rules":[{"type":"command","command":"/start"},{"type":"messageType","messageType":"photo"},{"type":"catchAll"}],"outputs":3,"x":370,"y":240,"wires":[["c763215f.75ea8"],["46f521dc.98695"],["475e775a.f208e8"]]},{"id":"c763215f.75ea8","type":"link out","z":"e945691.5e02098","name":"/start","links":["a8421bdc.f86c68"],"x":530,"y":200,"wires":[],"l":true},{"id":"3f81c018.96e4","type":"chatbot-telegram-send","z":"e945691.5e02098","bot":"ceee600a.9673d","botProduction":"ceee600a.9673d","track":false,"passThrough":false,"errorOutput":false,"outputs":0,"x":1630,"y":340,"wires":[]},{"id":"46f521dc.98695","type":"link out","z":"e945691.5e02098","name":"–ü—Ä–∏—Å–ª–∞–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É","links":["804b1151.b40a7"],"x":580,"y":240,"wires":[],"l":true},{"id":"18f629d3.e16bc6","type":"link in","z":"e945691.5e02098","name":"","links":["1f110f2d.0ec671","d839e1ba.e61e5","2e704f58.aad8e","16bf2bde.024124","63b43cf6.6aced4","1e999e85.8022b1"],"x":1475,"y":340,"wires":[["3f81c018.96e4"]]},{"id":"914db1e8.5b298","type":"link out","z":"e945691.5e02098","name":"–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–∫—É–ø–∫–∏","links":["9ea00699.029a98"],"x":470,"y":500,"wires":[],"l":true},{"id":"475e775a.f208e8","type":"switch","z":"e945691.5e02098","name":"–°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∞–¥–º–∏–Ω–∫–∏","property":"payload.content","propertyType":"msg","rules":[{"t":"cont","v":"–ú–æ–∏ –ø–æ–∫—É–ø–∫–∏","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":230,"y":420,"wires":[["914db1e8.5b298"]]},{"id":"534e1a03.1898a4","type":"debug","z":"e945691.5e02098","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1030,"y":200,"wires":[]},{"id":"2c99167a.17b29a","type":"debug","z":"e945691.5e02098","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1390,"y":200,"wires":[]},{"id":"4fa6660c.ee2418","type":"group","z":"e945691.5e02098","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["975cd689.244d68","35a642bc.6f84de","1e999e85.8022b1","9ea00699.029a98","d96db382.3f22","c4452476.f5a5e8"],"x":594,"y":459,"w":862,"h":82},{"id":"975cd689.244d68","type":"change","z":"e945691.5e02098","g":"4fa6660c.ee2418","name":"host + chat_id","rules":[{"t":"set","p":"host","pt":"msg","to":"46.101.245.26","tot":"str"},{"t":"set","p":"chat_id","pt":"msg","to":"payload.chatId","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":500,"wires":[["35a642bc.6f84de"]]},{"id":"35a642bc.6f84de","type":"http request","z":"e945691.5e02098","g":"4fa6660c.ee2418","name":"","method":"GET","ret":"obj","paytoqs":"ignore","url":"http://{{{host}}}/api/purchases/{{{chat_id}}}/","tls":"","persist":false,"proxy":"","authType":"","x":950,"y":500,"wires":[["c4452476.f5a5e8"]]},{"id":"1e999e85.8022b1","type":"link out","z":"e945691.5e02098","g":"4fa6660c.ee2418","name":"","links":["18f629d3.e16bc6"],"x":1415,"y":500,"wires":[]},{"id":"9ea00699.029a98","type":"link in","z":"e945691.5e02098","g":"4fa6660c.ee2418","name":"","links":["914db1e8.5b298"],"x":635,"y":500,"wires":[["975cd689.244d68"]]},{"id":"d96db382.3f22","type":"chatbot-message","z":"e945691.5e02098","g":"4fa6660c.ee2418","name":"","message":[{"message":"{{message}}"}],"language":"none","x":1310,"y":500,"wires":[["1e999e85.8022b1"]]},{"id":"c4452476.f5a5e8","type":"change","z":"e945691.5e02098","g":"4fa6660c.ee2418","name":"set purchases","rules":[{"t":"set","p":"message","pt":"msg","to":"payload.purchases","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1140,"y":500,"wires":[["d96db382.3f22"]]},{"id":"7a6506fe.b94048","type":"group","z":"e945691.5e02098","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["804b1151.b40a7","3fc035b.c9837ca","153d1e9e.72f651","b991f4b.42cc508","d839e1ba.e61e5","5a649caa.42bd94"],"x":694,"y":239,"w":642,"h":142},{"id":"804b1151.b40a7","type":"link in","z":"e945691.5e02098","g":"7a6506fe.b94048","name":"","links":["46f521dc.98695"],"x":735,"y":280,"wires":[["153d1e9e.72f651","b991f4b.42cc508"]]},{"id":"3fc035b.c9837ca","type":"http request","z":"e945691.5e02098","g":"7a6506fe.b94048","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"http://{{{host}}}/api/send_image/","tls":"","persist":false,"proxy":"","authType":"","x":1170,"y":280,"wires":[["d839e1ba.e61e5","2c99167a.17b29a"]]},{"id":"153d1e9e.72f651","type":"base64","z":"e945691.5e02098","g":"7a6506fe.b94048","name":"","action":"","property":"payload[\"content\"]","x":840,"y":280,"wires":[["534e1a03.1898a4","5a649caa.42bd94"]]},{"id":"b991f4b.42cc508","type":"chatbot-waiting","z":"e945691.5e02098","g":"7a6506fe.b94048","waitingType":"typing","x":940,"y":340,"wires":[["d839e1ba.e61e5"]]},{"id":"d839e1ba.e61e5","type":"link out","z":"e945691.5e02098","g":"7a6506fe.b94048","name":"","links":["18f629d3.e16bc6"],"x":1295,"y":340,"wires":[]},{"id":"5a649caa.42bd94","type":"change","z":"e945691.5e02098","g":"7a6506fe.b94048","name":"HOST","rules":[{"t":"set","p":"host","pt":"msg","to":"46.101.245.26","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":280,"wires":[["3fc035b.c9837ca"]]},{"id":"9aac92b.3ea137","type":"group","z":"e945691.5e02098","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["cf3c58ac.c04ab8","a8421bdc.f86c68","1f110f2d.0ec671"],"x":774,"y":59,"w":342,"h":82},{"id":"cf3c58ac.c04ab8","type":"chatbot-ask","z":"e945691.5e02098","g":"9aac92b.3ea137","name":"","buttons":[],"message":"üì∑ –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —á–µ–∫. \n\n–ù–∞ –Ω–µ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–æ—Ä–æ—à–æ –≤–∏–¥–µ–Ω QR-–∫–æ–¥.\n\n–õ—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–ª—É—á–∏—Ç—Å—è, –µ—Å–ª–∏:\n- —á–µ–∫ —Ö–æ—Ä–æ—à–æ –æ—Å–≤–µ—â–µ–Ω\n- –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ç–∫–æ–µ –∏ –Ω–µ —Å–º–∞–∑–∞–Ω–Ω–æ–µ\n\nüìé –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é —á–µ–∫–∞.","x":930,"y":100,"wires":[["1f110f2d.0ec671"]]},{"id":"a8421bdc.f86c68","type":"link in","z":"e945691.5e02098","g":"9aac92b.3ea137","name":"","links":["c763215f.75ea8"],"x":815,"y":100,"wires":[["cf3c58ac.c04ab8"]]},{"id":"1f110f2d.0ec671","type":"link out","z":"e945691.5e02098","g":"9aac92b.3ea137","name":"","links":["18f629d3.e16bc6"],"x":1075,"y":100,"wires":[]},{"id":"d37bd6d0.356f08","type":"group","z":"e945691.5e02098","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["ce37da06.d77778","8881c869.dfeef8","d502ca8b.1fc3d8","8f71927b.519ae","e56526e4.bf5608","181e0f.787401f2","16dbcb73.d6e6b5","179f1101.db754f","13cc75f8.4b395a","16bf2bde.024124","7613058.01585fc","a54514e0.5b4cf8","96386d9c.ddfd"],"x":114,"y":719,"w":1112,"h":242},{"id":"ce37da06.d77778","type":"http in","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","url":"/api/send","method":"get","upload":false,"swaggerDoc":"","x":210,"y":880,"wires":[["8881c869.dfeef8","7613058.01585fc"]]},{"id":"8881c869.dfeef8","type":"link out","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","links":["8f71927b.519ae","179f1101.db754f"],"x":335,"y":880,"wires":[]},{"id":"d502ca8b.1fc3d8","type":"chatbot-conversation","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","botDevelopment":"ceee600a.9673d","botProduction":"ceee600a.9673d","chatId":"","userId":"","transport":"telegram","store":"","x":770,"y":840,"wires":[["13cc75f8.4b395a"]]},{"id":"8f71927b.519ae","type":"link in","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","links":["52b211a3.f6757","8881c869.dfeef8"],"x":395,"y":840,"wires":[["e56526e4.bf5608"]]},{"id":"e56526e4.bf5608","type":"change","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","rules":[{"t":"set","p":"message","pt":"msg","to":"req.query.text","tot":"msg"},{"t":"set","p":"payload.chatId","pt":"msg","to":"req.query.chat_id","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":840,"wires":[["d502ca8b.1fc3d8"]]},{"id":"181e0f.787401f2","type":"http response","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","statusCode":"","headers":{},"x":670,"y":920,"wires":[]},{"id":"16dbcb73.d6e6b5","type":"template","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\"success\": true}","output":"json","x":530,"y":920,"wires":[["181e0f.787401f2"]]},{"id":"179f1101.db754f","type":"link in","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","links":["8881c869.dfeef8"],"x":395,"y":920,"wires":[["16dbcb73.d6e6b5"]]},{"id":"13cc75f8.4b395a","type":"chatbot-ask","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"–ú–æ–∏ –ø–æ–∫—É–ø–∫–∏","buttons":[{"type":"keyboardButton","label":"–ú–æ–∏ –ø–æ–∫—É–ø–∫–∏"}],"message":"{{message}}","x":930,"y":840,"wires":[["16bf2bde.024124"]]},{"id":"16bf2bde.024124","type":"link out","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","links":["18f629d3.e16bc6","79ac9ba6.430524"],"x":1035,"y":840,"wires":[]},{"id":"7613058.01585fc","type":"debug","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":430,"y":760,"wires":[]},{"id":"a54514e0.5b4cf8","type":"debug","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1110,"y":760,"wires":[]},{"id":"96386d9c.ddfd","type":"comment","z":"e945691.5e02098","g":"d37bd6d0.356f08","name":"sendMessage","info":"–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫—É –≤ –¢–µ–ª–µ–≥—Ä–∞–º","x":210,"y":760,"wires":[]},{"id":"e5d4e1be.77f6","type":"group","z":"e945691.5e02098","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["c2edf03b.c9472","82b781c4.2f71e","68ea1500.d64b9c","e2cb62.d34484a"],"x":1474,"y":759,"w":312,"h":142},{"id":"c2edf03b.c9472","type":"link in","z":"e945691.5e02098","g":"e5d4e1be.77f6","name":"","links":[],"x":1515,"y":800,"wires":[["82b781c4.2f71e","e2cb62.d34484a"]]},{"id":"82b781c4.2f71e","type":"chatbot-message","z":"e945691.5e02098","g":"e5d4e1be.77f6","name":"","message":[{"message":"–ö–Ω–æ–ø–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)"}],"language":"none","x":1630,"y":800,"wires":[["68ea1500.d64b9c"]]},{"id":"68ea1500.d64b9c","type":"link out","z":"e945691.5e02098","g":"e5d4e1be.77f6","name":"","links":[],"x":1735,"y":800,"wires":[]},{"id":"e2cb62.d34484a","type":"debug","z":"e945691.5e02098","g":"e5d4e1be.77f6","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1670,"y":860,"wires":[]},{"id":"ceee600a.9673d","type":"chatbot-telegram-node","botname":"${TG_BOT_NAME}","usernames":"","providerToken":"","polling":"1000","store":"","log":"","debug":true,"webHook":"","connectMode":"polling"}]